
os: linux
name: Dataset-load-AZ-legiscan

on: [push]

cd /opt
wget https://api.legiscan.com/dl/legiscan-current.tar.gz
tar zxvf legiscan-current.tar.gz
cd legiscan

php upgrade.php

mysql -u root -p
CREATE DATABASE legiscan_api DEFAULT CHARACTER SET utf8;
GRANT USAGE ON *.* TO 'legiscan_api'@'localhost' IDENTIFIED BY 'dihnah-ziNza8-wetkyn';
GRANT CREATE, ALTER, SELECT, INSERT, UPDATE, DELETE ON `legiscan_api`.* TO 'legiscan_api'@'localhost';
FLUSH PRIVILEGES;
exit

mysql -D legiscan_api -u root -p < schema-mysql.sql

sudo -u postgres createuser -S -D -R -P legiscan_api
Enter password for new role: dihnah-ziNza8-wetkyn
Enter it again: dihnah-ziNza8-wetkyn

sudo -u postgres createdb -E UTF8 -O legiscan_api legiscan_api

sudo -u postgres psql -U legiscan_api -f schema-pgsql.sql
